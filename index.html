<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>전자서명 동의서</title>
  <style>
    body { font-family: sans-serif; max-width: 600px; margin: 20px auto; }
    label { display: block; margin-top: 10px; }
    #signature-pad {
      border: 1px solid #ccc;
      width: 100%;
      height: 200px;
      touch-action: none;
    }
    .buttons { margin-top: 10px; }
    button { margin-right: 10px; }
  </style>
</head>
<body>
  <h1>전자서명 동의서</h1>
  <p>아래 내용을 입력하고 동의 후 서명을 해주세요.</p>

  <!-- ★ action에 하니의 이메일 주소 입력하기 ★ -->
  <form id="consent-form" action="https://formsubmit.co/hani.p@daum.net" method="POST">
    <!-- Formsubmit 설정용 숨김값 (스팸 방지, 리다이렉트 등은 나중에 추가해도 됨) -->
    <input type="hidden" name="_subject" value="전자서명 동의서 제출">
    
    <label>
      이름
      <input type="text" name="name" required>
    </label>

    <label>
      이메일
      <input type="email" name="email" required>
    </label>

    <label>
      <input type="checkbox" name="agree" value="yes" required>
      위 내용을 읽고 동의합니다.
    </label>

    <label>서명 (마우스/손가락으로 그려주세요)</label>
    <canvas id="signature-pad"></canvas>
    <div class="buttons">
      <button type="button" id="clear">서명 지우기</button>
    </div>

    <!-- 서명을 이미지 데이터(문자열)로 담을 숨은 입력창 -->
    <input type="hidden" name="signature" id="signature-input">

    <button type="submit">제출하기</button>
  </form>

  <!-- Signature Pad 라이브러리 (CDN) -->
  <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.2.0/dist/signature_pad.umd.min.js"></script>
  <script>
    // 캔버스와 시그니처패드 설정
    var canvas = document.getElementById("signature-pad");
    // 캔버스 크기를 화면에 맞게 조정
    function resizeCanvas() {
      var ratio = Math.max(window.devicePixelRatio || 1, 1);
      canvas.width = canvas.offsetWidth * ratio;
      canvas.height = canvas.offsetHeight * ratio;
      canvas.getContext("2d").scale(ratio, ratio);
    }
    window.addEventListener("resize", resizeCanvas);
    resizeCanvas();

    var signaturePad = new SignaturePad(canvas);

    // 지우기 버튼
    document.getElementById("clear").addEventListener("click", function () {
      signaturePad.clear();
    });

    // 폼 전송 전에 서명 데이터를 숨은 input에 넣기
    var form = document.getElementById("consent-form");
    form.addEventListener("submit", function (e) {
      if (signaturePad.isEmpty()) {
        alert("서명을 입력해주세요.");
        e.preventDefault();
        return;
      }
      // 서명 이미지를 base64 문자열로 변환 (PNG)
      var dataURL = signaturePad.toDataURL("image/png");
      document.getElementById("signature-input").value = dataURL;
    });
  </script>
</body>
</html>
